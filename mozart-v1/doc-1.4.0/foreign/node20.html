<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>7.13 Garbage collection</TITLE><LINK href="ozdoc.css" rel="stylesheet" type="text/css"></HEAD><BODY><TABLE align="center" border="0" cellpadding="6" cellspacing="6" class="nav"><TR bgcolor="#DDDDDD"><TD><A href="node19.html#section.cif.misc">&lt;&lt; Prev</A></TD><TD><A href="node7.html">- Up -</A></TD><TD><A href="node21.html#section.cif.io">Next &gt;&gt;</A></TD></TR></TABLE><DIV id="section.cif.garb"><H2><A name="section.cif.garb">7.13 Garbage collection</A></H2><P>Care must be taken about proper interaction with the Oz garbage collector: it does not notice if you store an <CODE>OZ_Term</CODE> into a global C variable. Therefore it will free the space on the heap occupied by this term, which leads to memory faults. Oz provides functions to explicitly inform the garbage collector about external references to the heap. </P><DL><DT><CODE>OZ_protect</CODE> <A name="label284"></A></DT><DD><BLOCKQUOTE class="synopsis"><P><CODE><SPAN class="type">int</SPAN>&nbsp;<SPAN class="functionname">OZ_protect</SPAN>(<SPAN class="type">OZ_Term</SPAN>&nbsp;*<SPAN class="variablename">tp</SPAN>)</CODE></P></BLOCKQUOTE></DD><DD><P>During garbage collection the term <CODE>tp</CODE> points to is visited and may be moved. Therefore <CODE>tp</CODE> must be a <EM>pointer</EM> to a term. The location where <CODE>tp</CODE> points to is modified by the garbage collector. </P></DD><DT><CODE>OZ_unprotect</CODE> <A name="label286"></A></DT><DD><BLOCKQUOTE class="synopsis"><P><CODE><SPAN class="type">int</SPAN>&nbsp;<SPAN class="functionname">OZ_unprotect</SPAN>(<SPAN class="type">OZ_Term</SPAN>&nbsp;*<SPAN class="variablename">tp</SPAN>)</CODE></P></BLOCKQUOTE></DD><DD><P>This is the inverse function to <CODE>OZ_protect</CODE> informing the garbage collector that the reference to the heap is no longer used. </P></DD><DT><CODE>OZ_gCollect</CODE> <A name="label288"></A></DT><DD><BLOCKQUOTE class="synopsis"><P><CODE><SPAN class="type">int</SPAN>&nbsp;<SPAN class="functionname">OZ_gCollect</SPAN>(<SPAN class="type">OZ_Term</SPAN>&nbsp;*<SPAN class="variablename">tp</SPAN>)</CODE> </P></BLOCKQUOTE></DD><DD><P>This function causes the Oz term referred to by <CODE>tp</CODE> to be updated during garbage collection. </P></DD><DT><CODE>OZ_sClone</CODE> <A name="label290"></A></DT><DD><BLOCKQUOTE class="synopsis"><P><CODE><SPAN class="type">int</SPAN>&nbsp;<SPAN class="functionname">OZ_sClone</SPAN>(<SPAN class="type">OZ_Term</SPAN>&nbsp;*<SPAN class="variablename">tp</SPAN>)</CODE></P></BLOCKQUOTE></DD><DD><P>This function causes the Oz term referred to by <CODE>tp</CODE> to be updated during cloning. </P></DD></DL><P></P></DIV><TABLE align="center" border="0" cellpadding="6" cellspacing="6" class="nav"><TR bgcolor="#DDDDDD"><TD><A href="node19.html#section.cif.misc">&lt;&lt; Prev</A></TD><TD><A href="node7.html">- Up -</A></TD><TD><A href="node21.html#section.cif.io">Next &gt;&gt;</A></TD></TR></TABLE><HR><ADDRESS><A href="http://www.ps.uni-sb.de/~mehl/">Michael&nbsp;Mehl</A>, <A href="http://www.ps.uni-sb.de/~tmueller/">Tobias&nbsp;Müller</A>, <A href="http://www.ps.uni-sb.de/~schulte/">Christian&nbsp;Schulte</A> and&nbsp;<A href="http://www.ps.uni-sb.de/~scheidhr/">Ralf&nbsp;Scheidhauer</A><BR><SPAN class="version">Version 1.4.0 (20080702)</SPAN></ADDRESS></BODY></HTML>
