<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>8.1.1 The class OZ_Extension</TITLE><LINK href="ozdoc.css" rel="stylesheet" type="text/css"></HEAD><BODY><TABLE align="center" border="0" cellpadding="6" cellspacing="6" class="nav"><TR bgcolor="#DDDDDD"><TD><A href="node22.html">- Up -</A></TD><TD><A href="node24.html#section.extension.reference.functions">Next &gt;&gt;</A></TD></TR></TABLE><DIV id="section.extension.reference.class"><H3><A name="section.extension.reference.class">8.1.1 The class <CODE>OZ_Extension</CODE></A></H3><P>The class <CODE>OZ_Extension</CODE> implements the methods defined below. The methods <CODE>getIdV</CODE>, <CODE>gCollectV</CODE>, and <CODE>sCloneV</CODE> which are marked as required are pure virtual and have to be implemented in every subclass. </P><DL class="exports"><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">int</SPAN>&nbsp;<SPAN class="functionname">getIdV</SPAN>()</CODE> // required <A name="label300"></A> </DT><DD><P>Allows to discriminate the different kinds of extensions. It should return a unique number. Unique numbers can be obtained using <CODE><SPAN class="type">int</SPAN>&nbsp;<SPAN class="functionname">OZ_getUniqueId</SPAN>()</CODE>. </P><P>Ids can be statically assigned by extending the enumeration <CODE>OZ_Registered_Extension_Id</CODE>. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Extension</SPAN>*&nbsp;<SPAN class="functionname">gCollectV</SPAN>()</CODE> // required <A name="label302"></A> </DT><DD><P>Needed for garbage collection. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Extension</SPAN>*&nbsp;<SPAN class="functionname">sCloneV</SPAN>()</CODE> // required <A name="label304"></A> </DT><DD><P>Needed for cloning of computation spaces (for <CODE>OZ_SituatedExtension</CODE>). </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">void</SPAN>&nbsp;<SPAN class="functionname">gCollectRecurseV</SPAN>()</CODE> // required <A name="label306"></A></DT><DD><P>Invoked on the copy obtained from <CODE>gCollectV</CODE>. The VM has marked the data such that recursive updates of fields, e.g. running <CODE>OZ_gCollect</CODE>, does not run into cycles. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">void</SPAN>&nbsp;<SPAN class="functionname">sCloneRecurseV</SPAN>()</CODE> // required <A name="label308"></A></DT><DD><P>Invoked on the copy obtained from <CODE>sCloneV</CODE>. The VM has marked the data such that recursive updates of fields, e.g. running <CODE>OZ_sClone</CODE>, does not run into cycles. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Term</SPAN>&nbsp;<SPAN class="functionname">printV</SPAN>(<SPAN class="type">int</SPAN>&nbsp;<SPAN class="variablename">depth</SPAN>&nbsp;=&nbsp;10)</CODE> // default: return <A name="label310"></A> <CODE>extension</CODE> </DT><DD><P>printV should return a virtual string and is used for printing, e.g. System.show. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Term</SPAN>&nbsp;<SPAN class="functionname">printLongV</SPAN>(<SPAN class="type">int</SPAN>&nbsp;<SPAN class="variablename">depth</SPAN>&nbsp;=&nbsp;10,&nbsp;<SPAN class="type">int</SPAN>&nbsp;<SPAN class="variablename">offset</SPAN>&nbsp;=&nbsp;0)</CODE> // default: call printV <A name="label312"></A> </DT><DD><P>This may help debugging, but is currently not used. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Term</SPAN>&nbsp;<SPAN class="functionname">typeV</SPAN>()</CODE> // default: return <CODE>extension</CODE> <A name="label314"></A> </DT><DD><P>typeV should return an atom describing the type of the extension. This value is also return in Value.status and Value.type. It should not conflict with the built-in types. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Term</SPAN>&nbsp;<SPAN class="functionname">inspectV</SPAN>()</CODE> // default: call typeV <A name="label316"></A></DT><DD><P>Not used. Idea: hook for debugging tools to get information. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">Oz_Boolean</SPAN>&nbsp;<SPAN class="functionname">isChunkV</SPAN>()</CODE> // default: return true <A name="label318"></A></DT><DD><P>Define this to return false is the extension in not a subtype of chunk. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Term</SPAN>&nbsp;<SPAN class="functionname">getFeatureV</SPAN>(<SPAN class="type">OZ_Term</SPAN>&nbsp;<SPAN class="variablename">fea</SPAN>)</CODE> // default: return 0 <A name="label320"></A></DT><DD><P>If the operator <CODE>.</CODE> (dot) is applied to an extension this function is called. If <CODE>getFeatureV</CODE> returns 0 an exception is raised that the feature is not available. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Return</SPAN>&nbsp;<SPAN class="functionname">getFeatureV</SPAN>(OZ_Term,<SPAN class="type">OZ_Term</SPAN>&amp;)</CODE> // default: return <CODE>OZ_FAILED</CODE> <A name="label322"></A> </DT><DD><P>The is the more basic version of the above, where a reference to the return value is passed as the 2nd argument. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Return</SPAN>&nbsp;<SPAN class="functionname">putFeatureV</SPAN>(OZ_Term,OZ_Term)</CODE> // default: return <CODE>OZ_FAILED</CODE> <A name="label324"></A> </DT><DD><P>Feature is 1st argument, new value is 2nd argument. This is used e.&nbsp;g. for <CODE><SPAN class="keyword">:=</SPAN></CODE> support. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Return</SPAN>&nbsp;<SPAN class="functionname">eqV</SPAN>(<SPAN class="type">OZ_Term</SPAN>&nbsp;<SPAN class="variablename">t</SPAN>)</CODE> // default: return false <A name="label326"></A></DT><DD><P>This function is called during unification and equality test (==), if both values are extensions. Implement it if you need structural equality. Note that in this case <CODE>isChunkV</CODE> should return false. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Boolean</SPAN>&nbsp;<SPAN class="functionname">toBePickledV</SPAN>()</CODE> // default: return false <A name="label328"></A></DT><DD><P>return true if pickling is defined. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Boolean</SPAN>&nbsp;<SPAN class="functionname">pickleV</SPAN>(<SPAN class="type">MarshalerBuffer</SPAN>&nbsp;*)</CODE> // default: return false <A name="label330"></A></DT><DD><P>This is the hook to pickling. It is only called when <CODE>toBePickledV</CODE> returned true, and must return true by itself. It writes the extension's external representation into the given buffer (see <CODE>oz_registerExtension</CODE> below). </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">OZ_Boolean</SPAN>&nbsp;<SPAN class="functionname">marshalSuspV</SPAN>(<SPAN class="type">OZ_Term</SPAN>&nbsp;<SPAN class="variablename">te</SPAN>,&nbsp;<SPAN class="type">ByteBuffer</SPAN>&nbsp;*,&nbsp;<SPAN class="type">GenTraverser</SPAN>&nbsp;*)</CODE> // default: return false <A name="label332"></A></DT><DD><P>This is the hook to serialization for Oz distribution. It returns true if the extension has been serialized, and writes its external representation/a fragment of into the given buffer (see <CODE>oz_registerExtension</CODE> below). It returns false if the extension cannot be serialized. </P></DD><DT><CODE><SPAN class="keyword">virtual</SPAN>&nbsp;<SPAN class="type">int</SPAN>&nbsp;<SPAN class="functionname">minNeededSpace</SPAN>()</CODE> // default: return 0 <A name="label334"></A> </DT><DD><P>This method is used by the Oz distribution's serialization routine. It must return the minimal possible size of the next fragment of the extension's external representation. This number must be consistent with the <CODE>marshalSuspV</CODE> method described above. </P></DD><DT><CODE><SPAN class="type">OZ_Boolean</SPAN>&nbsp;<SPAN class="functionname">isLocal</SPAN>()</CODE> <A name="label336"></A></DT><DD><P>Returns true if a situated extensions is local to the current space. </P></DD></DL><P> </P></DIV><TABLE align="center" border="0" cellpadding="6" cellspacing="6" class="nav"><TR bgcolor="#DDDDDD"><TD><A href="node22.html">- Up -</A></TD><TD><A href="node24.html#section.extension.reference.functions">Next &gt;&gt;</A></TD></TR></TABLE><HR><ADDRESS><A href="http://www.ps.uni-sb.de/~mehl/">Michael&nbsp;Mehl</A>, <A href="http://www.ps.uni-sb.de/~tmueller/">Tobias&nbsp;Müller</A>, <A href="http://www.ps.uni-sb.de/~schulte/">Christian&nbsp;Schulte</A> and&nbsp;<A href="http://www.ps.uni-sb.de/~scheidhr/">Ralf&nbsp;Scheidhauer</A><BR><SPAN class="version">Version 1.4.0 (20080702)</SPAN></ADDRESS></BODY></HTML>
